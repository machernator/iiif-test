const NHMSearch=(e,t,n)=>{const o={},a={};let r,c,s,i=".crudbox";function d(e){const t=e.target.closest("li")??e.target.closest("tr"),n=t.dataset.entryid,o=t.dataset.entryname,r=t.closest(i);c.value="",c.focus(),void 0!==o&&void 0!==n&&a[s.id].call(r,n,o),p()}function u(e){return e.target.closest(".nhm-search-result")||p(),!1}function l(e){"Escape"==e.key&&p()}function h(){!async function(e){s=e;const t=e.querySelector('[data-searchfield="1"]');c=t;const n=e.dataset.action,a=t.value.trim();showLoadingAnimation(t);const i=new FormData;i.append("search",a);const d=await fetch(n,{method:"POST",body:i}),h=await d.text();e.querySelector(".nhm-search-result").innerHTML=h,document.body.addEventListener("pointerup",u),document.addEventListener("keyup",l),r=e.id,o[r].show(),hideLoadingAnimation()}(this)}function p(){document.removeEventListener("keyup",l),document.body.removeEventListener("pointerup",u),o[r].hide();s.querySelector("[data-searchfield]");r="",c.focus()}return function(e,t,n){let r;if(r=e instanceof Element||e instanceof Document?e:document.getElementById(e),!r)return null;n&&(i=n);const c=r.querySelector("[data-searchwrapper]");if(c){a[c.id]=t;c.querySelector('[data-searchbutton="1"]').addEventListener("pointerup",h.bind(c));c.querySelector('[data-searchfield="1"]').addEventListener("keydown",(e=>{"Enter"===e.key&&(e.stopPropagation(),e.preventDefault(),h.call(c))}));const e=c.querySelector(".nhm-search-result");o[c.id]=new bootstrap.Collapse(e,{toggle:!1}),e.addEventListener("pointerup",d),e.addEventListener("hidden.bs.collapse",(t=>{e.innerHTML=""}))}}(e,t,n),{search:h}};window.NHMSearch=NHMSearch;export{NHMSearch as default};
//# sourceMappingURL=nhm-search.min.js.map