!function(){function e(){s.innerText=`${personTitle.value} ${personFirstName.value} ${personMiddleName.value} ${personLastName.value}`}let t;NHMSearch("personSearch",(function(e,t){window.location.assign("/person/"+e)})),NHMSearch("personInstitutesSearch",(function(e,n){t.currInstId=e,t.currText=n})),Signals.add("onAdd_externalRefs",(function(e){const t=this.querySelector(".cat-select"),n=t.selectedOptions,s=e.newEl;if("default"===t.value){const e=t.dataset.msgnocategory;return alert(e),s.remove(),void t.focus()}const r=n[0].dataset.url,i=n[0].dataset.shortcode,u=document.getElementById("newReference"),l=s.querySelector('[name^="IDENTCAT_ID"]'),a=s.querySelector('[name^="identifier"]');l.value=t.value,t.selectedIndex=null,a.value=u.value;const c=document.createElement("a");c.href=r+u.value,c.target="_blank",c.innerText=i+" - "+u.value,s.querySelector(".crudbox-entry-text").appendChild(c)})),window.addEventListener("alpine:init",(e=>{Alpine.store("personInstitutes",{institutes:null,currInstId:null,currText:"",messages:null,addInstitute(e,t){if(null===this.currInstId)return;if(this.checkDoubleEntries(this.currInstId,e.value,t.value))return alert(this.messages.doubleEntry),void this.resetSelection();const n={INST_ID:this.currInstId,date_start:e.value,date_end:t.value,institute_name:this.currText,is_preferred:!1};this.institutes.unshift(n),Alpine.nextTick((()=>{Signals.dispatch("saveObject",{},null)})),this.resetSelection()},deleteInstitute(e){this.institutes.splice(e,1),Alpine.nextTick((()=>{Signals.dispatch("saveObject",{},null)}))},resetSelection(){this.currInstId=null,this.currText=null},checkDoubleEntries(e,t,n){for(let s=0;s<this.institutes.length;s++)if(this.institutes[s].INST_ID==e&&this.institutes[s].dateStart==t&&this.institutes[s].dateEnd==n)return!0;return!1},setIsPreferred(e,t){const n=document.querySelectorAll('[type="checkbox"][name$="[is_preferred]"');for(let t=0;t<n.length;t++)t!==e&&(n[t].checked=!1)}}),t=Alpine.store("personInstitutes")}));const n=document.getElementById("personInstitutesSearchInput");n&&n.addEventListener("keydown",(function(e){"Enter"===e.key&&e.preventDefault()}));const s=document.getElementById("personFullNameHeading"),r=document.getElementById("personTitle"),i=document.getElementById("personFirstName"),u=document.getElementById("personMiddleName"),l=document.getElementById("personLastName");s&&i&&u&&l&&(r.addEventListener("input",(function(t){e()})),i.addEventListener("input",(function(t){e()})),u.addEventListener("input",(function(t){e()})),l.addEventListener("input",(function(t){e()})))}();
//# sourceMappingURL=persons.min.js.map