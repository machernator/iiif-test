"use strict";!function(){function e(e,t){const s=this.querySelector("[data-searchid]"),c=this.querySelector("[data-searchtext]");c.innerText=t,s.dataset.appendvalue=e,c.dataset.appendvalue=t}Signals.add("saveObject",(function(e,c,i){const n=new FormData(t);axios({method:"post",url:s,data:n}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}));const t=document.getElementById("objectForm"),s=t.action;t.addEventListener("submit",(e=>e.preventDefault())),t.addEventListener("change",(e=>{e.target.getAttribute("data-nosaveonchange")||Signals.dispatch("saveObject")}));t.querySelectorAll('[data-ismultiline="1"]').forEach((e=>{e.addEventListener("keydown",(e=>{"Enter"===e.key&&e.preventDefault()}))})),Alpine.store("systematics",{systematics:{},selectEntry(e,t,s){this.checkDoubleEntries(t,s.entryId)?alert(this.systematics[t].messages.doubleEntry):"select_node"===s.action?(this.systematics[t].currentSelection.text=e,this.systematics[t].currentSelection.id=s.entryId):(this.systematics[t].currentSelection.text="",this.systematics[t].currentSelection.id=null)},addEntry(e,t){const s=this.appendFieldsObject(e),c={node_name:this.systematics[e].currentSelection.text,NODE_ID:this.systematics[e].currentSelection.id,is_preferred:!1,...s};"single"===t?(this.systematics[e].entries.splice(0,this.systematics[e].entries.length),this.systematics[e].entries.push(c)):this.systematics[e].entries.unshift({node_name:this.systematics[e].currentSelection.text,NODE_ID:this.systematics[e].currentSelection.id,is_preferred:!1,...s}),this.systematics[e].currentSelection.text="",this.systematics[e].currentSelection.id=null,this.systematics[e].appendFields.forEach((e=>{e.dataset.appendvalue="";const t=e.tagName;"INPUT"===t||"TEXTAREA"===t?e.value="":"SELECT"===t?e.selectedIndex=0:e.innerText=""})),Alpine.nextTick((()=>{Signals.dispatch("saveObject",{},null)}))},deleteEntry(e,t){this.systematics[t].entries.splice(e,1),this.systematics[t].preferredEntry=null,Alpine.nextTick((()=>{Signals.dispatch("saveObject",{},null)}))},setIsPreferred(e,t,s){const c=document.querySelectorAll(`#${t} [type="checkbox"][name$="[is_preferred]"]`);for(let i=0;i<this.systematics[t].entries.length;i++)i===e?this.systematics[t].entries[i].is_preferred=s:(this.systematics[t].entries[i].is_preferred=!1,c[i].checked=!1);Alpine.nextTick((()=>{Signals.dispatch("saveObject",{},null)}))},appendFieldsObject(e){const t={};return this.systematics[e].appendFields.forEach((e=>{const s=e.getAttribute("data-appendfield");t[s]=e.dataset.appendvalue})),t},checkDoubleEntries(e,t){const s=this.systematics[e].entries;for(let e=0;e<s.length;e++)if(s[e].NODE_ID===t)return!0;return!1},addSystematic(e,t,s,c){const i=document.querySelectorAll(`#${c} [data-appendfield]`);this.systematics[c]={entries:e,currentSelection:t,appendFields:i,messages:s}}});document.querySelectorAll(".date-special").forEach((e=>{e.addEventListener("input",(e=>{let t,s=e.target.value;s=s.replace(/[^0-9-]/g,"");let c=s.length;const i=s[c-1];switch(c){case 1:case 2:case 3:case 4:s=s.replace("-","");break;case 5:case 8:t=c-1,"-"!==s[t]&&(s=s.slice(0,-1)+"-"+s.slice(-1));break;case 6:("-"!==i&&i>1||"-"===i)&&(s=s.slice(0,-1));break;case 7:"-"===i&&(s=s.slice(0,-1)),"1"===s[5]&&s[6]>2&&(s=s.slice(0,-1));break;case 9:"-"!==i&&i>3&&(s=s.slice(0,-1));case 10:"-"===i&&(s=s.slice(0,-1)),"3"===s[8]&&s[9]>1&&(s=s.slice(0,-1));break;case 11:s=s.slice(0,-1)}e.target.value=s}))}));document.querySelectorAll(".object-systematics").forEach((e=>{const t=e.id;window.SystematicsTree(t,((e,s,c)=>{Alpine.store("systematics").selectEntry(s,t,c)}))}));document.querySelectorAll("[data-taxonomysearch]").forEach((t=>{NHMSearch(t,e,"#"+t.id)}));const c=document.getElementById("objectNavSearch");NHMSearch(c,(function(e,t){window.location.href="/object/"+e}),"#objectNavSearch")}();
//# sourceMappingURL=object-edit.min.js.map