function initCrudBox(e){e.dataset.crudboxtype;const t=e.querySelector("[data-crudboxadd]");t&&t.addEventListener("keydown",onCrudboxKeydown),e.addEventListener("pointerdown",onCrudBoxClicked)}function initReferences(e){}function onCrudBoxClicked(e){e.target.hasAttribute("data-addbtn")?addValue(e.currentTarget):e.target.hasAttribute("data-delete")&&deleteEntry(e.target)}function onCrudboxKeydown(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),addValue(e.target.closest(".crudbox")))}function deleteEntry(e){e.closest(".crudbox-entry").remove(),Signals.dispatch("saveFormData",{},e)}function addValue(e){const t=e.querySelector("[data-crudboxlist]"),r=e.querySelector("[data-crudboxadd]");e.dataset.crudboxtype;if(!r.value)return;const o=e.id;if(crudboxValueExists(t,r.value))return void(r.value="");const d=e.querySelector("template").content.cloneNode(!0);t.appendChild(d);const u=t.lastElementChild,a=u.querySelector(".crudbox-input");a&&(a.value=r.value,u.querySelector(".crudbox-entry-text").innerHTML=r.value),Signals.dispatch(`onAdd_${o}`,{newEl:u},e),r.value="",r.focus(),Signals.dispatch("saveFormData",{},e)}function crudboxValueExists(e,t){const r=e.querySelectorAll(".crudbox-input");let o=!1;return r.forEach((e=>{e.value==t&&(o=!0)})),o}function addValueFromOutside(e,t,r){const o=e.querySelector("[data-crudboxlist]");if(crudboxValueExists(o,r)){const t=e.querySelector("[data-crudboxadd]"),r=e.querySelector("[data-searchfield]");return t&&(t.value=""),r&&(r.value=""),null}const d=e.querySelector("template").content.cloneNode(!0);o.appendChild(d);const u=o.lastElementChild,a=u.querySelector(".crudbox-input");return a&&(a.value=r),u.querySelector(".crudbox-entry-text").innerHTML=t,u}const crudBoxes=document.querySelectorAll(".crudbox");crudBoxes.forEach((e=>initCrudBox(e)));const currentValues={},CrudBox={crudBoxes:crudBoxes,addValue:addValueFromOutside};window.CrudBox=CrudBox;export{CrudBox as default};
//# sourceMappingURL=crudbox.min.js.map