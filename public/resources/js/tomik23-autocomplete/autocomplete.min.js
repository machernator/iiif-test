var Autocomplete=function(){"use strict";const t=t=>t&&"object"==typeof t&&t.constructor===Object,e=t=>Boolean(t&&"function"==typeof t.then),s=(t,e)=>{for(let s in e){"addClass"===s?l(t,"add",e[s]):"removeClass"===s?l(t,"remove",e[s]):t.setAttribute(s,e[s])}},i=t=>(t.firstElementChild||t).textContent.trim(),h=(t,e)=>{t.scrollTop=t.offsetTop-e.offsetHeight},o=t=>{for(let e=0;e<t.length;e++){s(t[e],{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":t.length,"aria-posinset":e})}},r=function(t,e){void 0===t&&(t=!1),t&&(l(t,"remove","hidden"),p(t,"click",e))},l=(t,e,s)=>t.classList[e](s),n=(t,e)=>{s(t,{"aria-activedescendant":e||""})},_=(t,e)=>{const s=document.querySelectorAll("#"+t+" > li:not(."+e+")");let i=0;return[].slice.call(s).map((t=>i+=t.offsetHeight)),i},a=(t,e,s,i)=>{const h=i.previousSibling,o=h?h.offsetHeight:0;if("0"==t.getAttribute("aria-posinset")&&(i.scrollTop=t.offsetTop-_(e,s)),t.offsetTop-o<i.scrollTop){i.scrollTop=t.offsetTop-o}else{const e=t.offsetTop+t.offsetHeight-o,s=undefined;e>i.scrollTop+i.offsetHeight&&(i.scrollTop=e-i.offsetHeight)}},c=(t,e,i,h,o)=>{s(e,{id:i,tabIndex:"0",role:"listbox"}),s(h,{addClass:o+"-results-wrapper"}),h.insertAdjacentElement("beforeend",e),t.parentNode.insertBefore(h,t.nextSibling)},d=t=>document.createElement(t),u=t=>document.querySelector(t),p=(t,e,s)=>{t.addEventListener(e,s)},m=(t,e,s)=>{t.removeEventListener(e,s)},x=27,v=13,f=38,L=40,g=9;class b{constructor(_,b){let{delay:A=500,clearButton:y=!0,howManyCharacters:C=1,selectFirst:S=!1,insertToInput:B=!1,showAllValues:k=!1,cache:T=!1,disableCloseOnSelect:w=!1,classGroup:I,classPreventClosing:F,classPrefix:O,ariaLabelClear:R,onSearch:E,onResults:j=(()=>{}),onSubmit:D=(()=>{}),onOpened:W=(()=>{}),onReset:G=(()=>{}),onRender:H=(()=>{}),onClose:V=(()=>{}),noResults:q=(()=>{}),onSelectedItem:M=(()=>{})}=b;this._initial=()=>{this._clearbutton(),c(this._root,this._resultList,this._outputUl,this._resultWrap,this._prefix),p(this._root,"input",this._handleInput),this._showAll&&p(this._root,"click",this._handleInput),this._onRender({element:this._root,results:this._resultList})},this._cacheAct=(t,e)=>{this._cache&&("update"===t?this._root.setAttribute(this._cacheData,e.value):"remove"===t?this._root.removeAttribute(this._cacheData):this._root.value=this._root.getAttribute(this._cacheData))},this._handleInput=t=>{let{target:e,type:s}=t;if("true"===this._root.getAttribute("aria-expanded")&&"click"===s){return}const i=e.value.replace(this._regex,"\\$&");this._cacheAct("update",e);const h=this._showAll?0:this._delay;clearTimeout(this._timeout),this._timeout=setTimeout((()=>{this._searchItem(i.trim())}),h)},this._reset=()=>{var t;s(this._root,{"aria-owns":this._id+"-list","aria-expanded":"false","aria-autocomplete":"list","aria-activedescendant":"",role:"combobox",removeClass:"auto-expanded"}),l(this._resultWrap,"remove",this._isActive),(0==(null==(t=this._matches)?void 0:t.length)&&!this._toInput||this._showAll)&&(this._resultList.textContent=""),this._index=this._selectFirst?0:-1,this._onClose()},this._searchItem=e=>{this._value=e,this._onLoading(!0),r(this._clearBtn,this.destroy),0==e.length&&this._clearButton&&l(this._clearBtn,"add","hidden"),this._characters>e.length&&!this._showAll?this._onLoading():this._onSearch({currentValue:e,element:this._root}).then((s=>{const i=this._root.value.length,h=s.length;this._matches=Array.isArray(s)?s:JSON.parse(JSON.stringify(s)),this._onLoading(),this._error(),0==h&&0==i&&l(this._clearBtn,"add","hidden"),0==h&&i?(l(this._root,"remove","auto-expanded"),this._reset(),this._noResults({element:this._root,currentValue:e,template:this._results}),this._events()):(h>0||t(s))&&(this._index=this._selectFirst?0:-1,this._results(),this._events())})).catch((()=>{this._onLoading(),this._reset()}))},this._onLoading=t=>this._root.parentNode.classList[t?"add":"remove"](this._isLoading),this._error=()=>l(this._root,"remove",this._err),this._events=()=>{p(this._root,"keydown",this._handleKeys),p(this._root,"click",this._handleShowItems),["mousemove","click"].map((t=>{p(this._resultList,t,this._handleMouse)})),p(document,"click",this._handleDocClick)},this._results=t=>{s(this._root,{"aria-expanded":"true",addClass:this._prefix+"-expanded"}),this._resultList.textContent="";const e=0===this._matches.length?this._onResults({currentValue:this._value,matches:0,template:t}):this._onResults({currentValue:this._value,matches:this._matches,classGroup:this._classGroup});this._resultList.insertAdjacentHTML("afterbegin",e),l(this._resultWrap,"add",this._isActive);const i=this._classGroup?":not(."+this._classGroup+")":"";this._itemsLi=document.querySelectorAll("#"+this._outputUl+" > li"+i),o(this._itemsLi),this._onOpened({type:"results",element:this._root,results:this._resultList}),this._selectFirstElement(),h(this._resultList,this._resultWrap)},this._handleDocClick=t=>{let{target:e}=t,s=null;(e.closest("ul")&&this._disable||e.closest("."+this._prevClosing))&&(s=!0),e.id===this._id||s||this._reset()},this._selectFirstElement=()=>{if(this._removeAria(u("."+this._activeList)),!this._selectFirst){return}const{firstElementChild:t}=this._resultList,e=this._classGroup&&this._matches.length>0&&this._selectFirst?t.nextElementSibling:t;this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]}),s(e,{id:this._selectedOption+"-0",addClass:this._activeList,"aria-selected":"true"}),n(this._root,this._selectedOption+"-0")},this._handleShowItems=()=>{this._resultList.textContent.length>0&&!l(this._resultWrap,"contains",this._isActive)&&(s(this._root,{"aria-expanded":"true",addClass:this._prefix+"-expanded"}),l(this._resultWrap,"add",this._isActive),h(this._resultList,this._resultWrap),this._selectFirstElement(),this._onOpened({type:"showItems",element:this._root,results:this._resultList}))},this._handleMouse=t=>{t.preventDefault();const{target:e,type:s}=t,i=e.closest("li"),h=null==i?void 0:i.hasAttribute("role"),o=this._activeList,r=u("."+o);i&&h&&("click"===s&&this._getTextFromLi(i),"mousemove"!==s||l(i,"contains",o)||(this._removeAria(r),this._setAria(i),this._index=this._indexLiSelected(i),this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]})))},this._getTextFromLi=t=>{t&&0!==this._matches.length?(this._clearButton&&l(this._clearBtn,"remove","hidden"),this._root.value=i(t),this._onSubmit({index:this._index,element:this._root,object:this._matches[this._index],results:this._resultList}),this._disable||(this._removeAria(t),this._reset()),this._cacheAct("remove")):!this._disable&&this._reset()},this._indexLiSelected=t=>Array.prototype.indexOf.call(this._itemsLi,t),this._handleKeys=t=>{const{keyCode:e}=t,s=l(this._resultWrap,"contains",this._isActive),h=this._matches.length+1;switch(this._selectedLi=u("."+this._activeList),e){case f:case L:if(t.preventDefault(),h<=1&&this._selectFirst||!s){return}e===f?(this._index<0&&(this._index=h-1),this._index-=1):(this._index+=1,this._index>=h&&(this._index=0)),this._removeAria(this._selectedLi),this._index>=0&&this._index<h-1?(this._toInput&&s&&(this._root.value=i(this._itemsLi[this._index])),this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]}),this._setAria(this._itemsLi[this._index])):(this._cacheAct(),n(this._root),this._onSelected({index:null,element:this._root,object:null}));break;case v:this._getTextFromLi(this._selectedLi);break;case g:case x:t.stopPropagation(),this._reset();break}},this._setAria=t=>{const e=this._selectedOption+"-"+this._indexLiSelected(t);s(t,{id:e,"aria-selected":"true",addClass:this._activeList}),n(this._root,e),a(t,this._outputUl,this._classGroup,this._resultList)},this._removeAria=t=>{t&&s(t,{id:"",removeClass:this._activeList,"aria-selected":"false"})},this._clearbutton=()=>{this._clearButton&&(s(this._clearBtn,{class:this._prefix+"-clear hidden",type:"button",title:this._clearBtnAriLabel,"aria-label":this._clearBtnAriLabel}),this._root.insertAdjacentElement("afterend",this._clearBtn))},this.destroy=()=>{this._clearButton&&l(this._clearBtn,"add","hidden"),this._root.value="",this._root.focus(),this._resultList.textContent="",this._reset(),this._error(),this._onReset(this._root),m(this._root,"keydown",this._handleKeys),m(this._root,"click",this._handleShowItems),m(document,"click",this._handleDocClick)},this._id=_,this._root=document.getElementById(_),this._onSearch=e(E)?E:t=>{let{currentValue:e,element:s}=t;return Promise.resolve(E({currentValue:e,element:s}))},this._onResults=j,this._onRender=H,this._onSubmit=D,this._onSelected=M,this._onOpened=W,this._onReset=G,this._noResults=q,this._onClose=V,this._delay=A,this._characters=C,this._clearButton=y,this._selectFirst=S,this._toInput=B,this._showAll=k,this._classGroup=I,this._prevClosing=F,this._clearBtnAriLabel=R||"clear the search query",this._prefix=O?O+"-auto":"auto",this._disable=w,this._cache=T,this._outputUl=this._prefix+"-"+this._id+"-results",this._cacheData="data-cache-auto-"+this._id,this._isLoading=this._prefix+"-is-loading",this._isActive=this._prefix+"-is-active",this._activeList=this._prefix+"-selected",this._selectedOption=this._prefix+"-selected-option",this._err=this._prefix+"-error",this._regex=/[|\\{}()[\]^$+*?.]/g,this._timeout=null,this._resultWrap=d("div"),this._resultList=d("ul"),this._clearBtn=d("button"),this._initial()}}return b}();
//# sourceMappingURL=autocomplete.min.js.map